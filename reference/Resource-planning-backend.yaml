openapi: 3.0.0
info:
  title: Resource planning backend
  version: '1.0'
servers:
  - url: 'http://localhost:3000'
paths:
  /users/authenticate:
    post:
      summary: authenticate
      operationId: post-users-authenticate
      parameters: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                sLogin:
                  type: string
                sPassword:
                  type: string
              required:
                - sLogin
                - sPassword
            examples: {}
        description: ''
      description: Авторизация пользователя по логину и паролю
      tags:
        - users
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                oneOf:
                  - properties:
                      sUserName:
                        type: string
                        description: Имя пользователя для заголовка
                      sToken:
                        type: string
                        description: Токен JWT
                      sRefreshToken:
                        type: string
                        description: Токен JWT
                    required:
                      - sUserName
                      - sToken
                      - sRefreshToken
                  - properties:
                      sError:
                        type: string
                        description: Текст причины неуспешной авторизации
                    required:
                      - sError
                type: object
  /users/refreshToken:
    post:
      summary: refreshToken
      operationId: post-users-refreshToken
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  sToken:
                    type: string
                  sRefreshToken:
                    type: string
                required:
                  - sToken
                  - sRefreshToken
        '401':
          description: Unauthorized
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                sToken:
                  type: string
                sRefreshToken:
                  type: string
              required:
                - sToken
                - sRefreshToken
      tags:
        - users
      description: Обновление токена авторизации
  /common/getMenu:
    get:
      summary: getMenu
      tags:
        - common
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  aProducts:
                    type: array
                    description: список продуктов
                    items:
                      type: object
                      description: Данные одного продукта
                      properties:
                        iId:
                          type: number
                          description: Id продукта
                        sName:
                          type: string
                          description: Название продукта
                        aDepartments:
                          type: array
                          description: Список подразделений продукта
                          items:
                            type: object
                            description: Данные одного подразделения
                            properties:
                              iId:
                                type: number
                                description: Id подразделения
                              sName:
                                type: string
                                description: Название подразделения
                            required:
                              - iId
                              - sName
                      required:
                        - iId
                        - sName
                        - aDepartments
                required:
                  - aProducts
      operationId: get-getMenu
      description: Получение содержимого меню для левой панели
    parameters: []
  /masterData/importRoles:
    post:
      summary: importRoles
      operationId: post-import-roles
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ImportMasterDataResultDto'
      description: Загрузка мастер-данных ролей и доступа
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ImportMasterDataRequestDto'
      tags:
        - masterData
    parameters: []
  /masterData/getRoles:
    get:
      summary: getRoles
      tags:
        - masterData
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  oData:
                    $ref: '#/components/schemas/DataGridDto'
                required:
                  - oData
      operationId: get-masterData-getRoles
      description: Получение импортированных ролей
  /masterData/importPositions:
    post:
      summary: importPositions
      operationId: post-import-positions
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ImportMasterDataResultDto'
      description: Загрузка мастер-данных позиций
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ImportMasterDataRequestDto'
      tags:
        - masterData
    parameters: []
  /masterData/getPositions:
    get:
      summary: getPositions
      tags:
        - masterData
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  oData:
                    $ref: '#/components/schemas/DataGridDto'
                required:
                  - oData
      operationId: get-masterData-getPositions
      description: Получение импортированных позиций
  /masterData/importOrgStructure:
    post:
      summary: importOrgStructure
      operationId: post-import-org-structure
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ImportMasterDataResultDto'
      description: Загрузка мастер-данных оргструктуры
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ImportMasterDataRequestDto'
      tags:
        - masterData
    parameters: []
  /masterData/importJobs:
    post:
      summary: importJobs
      operationId: post-import-jobs
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ImportMasterDataResultDto'
      description: Загрузка мастер-данных каталога должностей
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ImportMasterDataRequestDto'
      tags:
        - masterData
    parameters: []  
  /masterData/importFaq:
    post:
      summary: importFaq
      operationId: post-import-faq
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ImportMasterDataResultDto'
      description: Загрузка мастер-данных FAQ
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ImportMasterDataRequestDto'
      tags:
        - masterData
    parameters: []    
  /masterData/importCurrencies:
    post:
      summary: importCurrencies
      operationId: post-import-currencies
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ImportMasterDataResultDto'
      description: Загрузка мастер-данных валют
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ImportMasterDataRequestDto'
      tags:
        - masterData
    parameters: []
  /masterData/getOrgStructure:
    get:
      summary: getOrgStructure
      tags:
        - masterData
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  oData:
                    $ref: '#/components/schemas/DataGridDto'
                required:
                  - oData
      operationId: get-masterData-getRoles
      description: Получение импортированной оргструктуры
  /masterData/getJobs:
    get:
      summary: getJobs
      tags:
        - masterData
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  oData:
                    $ref: '#/components/schemas/DataGridDto'
                required:
                  - oData
      operationId: get-masterData-getRoles
      description: Получение импортированного каталога должностей    
  /masterData/getFaq:
    get:
      summary: getFaq
      tags:
        - masterData
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  oData:
                    $ref: '#/components/schemas/DataGridDto'
                required:
                  - oData
      operationId: get-masterData-getRoles
      description: Получение импортированного FAQ
  /masterData/getCurrencies:
    get:
      summary: getCurrencies
      tags:
        - masterData
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  oData:
                    $ref: '#/components/schemas/DataGridDto'
                required:
                  - oData
      operationId: get-masterData-getCurrencies
      description: Получение импортированных валют
components:
  schemas:
    DataGridDto:
      title: DataGridDto
      type: object
      description: Таблица с данными
      properties:
        aHeader:
          type: array
          description: Заголовок таблицы
          items:
            type: object
            description: Данные колонки
            properties:
              sValue:
                type: string
                description: Название колонки
            required:
              - sValue
        aRows:
          type: array
          description: Строки таблицы
          items:
            type: object
            description: Данные строки
            properties:
              aCells:
                type: array
                description: Ячейки строки
                items:
                  type: object
                  description: Данные ячейки строки
                  properties:
                    sValue:
                      type: string
                      description: Значение ячейки
            required:
              - aCells
      required:
        - aHeader
        - aRows
    ImportMasterDataRequestDto:
      title: ImportMasterDataRequestDto
      type: object
      properties:
        sFileContent:
          type: string
          description: 'Содержимое файла, с префиксом data:text/plain;base64,'
      required:
        - sFileContent
      description: Мастер-данные для импорта
    ImportMasterDataResultDto:
      title: ImportMasterDataResultDto
      type: object
      properties:
        bSuccess:
          type: boolean
          description: Признак успешной загрузки
        sError:
          type: string
          description: 'Описание ошибок загрузки, если они есть'
      required:
        - bSuccess
      description: Результат импорта мастер-данных
